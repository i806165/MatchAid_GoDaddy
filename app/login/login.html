    <header class="pageHeader" role="banner">
        <div class="hdrLeft">
            <div class="hdrLeftSlot" aria-hidden="true"></div>

            <div class="hdrTitleWrap">
                <div id="title" class="hdrTitle text--title ink--brand">MatchAid Login</div>
                <div id="subtitle" class="hdrSub text--subtitle ink--brand">Sign in to continue</div>
            </div>

            <div class="hdrRight" aria-hidden="true"></div>
        </div>
    </header>

    <div class="controls" id="controls">
        <div class="controlsRow">
        </div>
    </div>

    <main class="content" id="content" role="main">
        <section class="card" aria-label="MatchAid login form">
            <div class="cardHdr">
                <div class="text--section ink--default">Credentials</div>
                <div id="busyBadge" class="hintLine text--caption ink--muted hidden" aria-live="polite">
                    <span class="spin" aria-hidden="true"></span>
                    <span>Working…</span>
                </div>
            </div>

            <div class="formGrid" aria-label="Login fields">
                <div class="rowLabel text--label">Email or User-ID</div>
                <input id="inputUserId" class="ctrl" type="text" autocomplete="username" inputmode="email" />

                <div class="rowLabel text--label">Password</div>
                <div class="pwdWrap">
                    <input id="inputPassword" class="ctrl" type="password" autocomplete="current-password"
                        aria-describedby="pwdToggleHint" />
                    <button id="btnPwdToggle" class="pwdToggle" type="button" aria-label="Show password"
                        title="Show password">
                        <!-- eye -->
                        <svg id="icoEye" class="pwdIco" viewBox="0 0 24 24" aria-hidden="true">
                            <path
                                d="M12 5c-5.05 0-9.27 3.11-11 7 1.73 3.89 5.95 7 11 7s9.27-3.11 11-7c-1.73-3.89-5.95-7-11-7Zm0 11a4 4 0 1 1 0-8 4 4 0 0 1 0 8Zm0-2a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" />
                        </svg>
                        <!-- eye-off -->
                        <svg id="icoEyeOff" class="pwdIco hidden" viewBox="0 0 24 24" aria-hidden="true">
                            <path
                                d="M2.1 3.51 3.51 2.1l18.38 18.38-1.41 1.41-2.06-2.06A11.93 11.93 0 0 1 12 20C6.95 20 2.73 16.89 1 13c.88-1.98 2.29-3.7 4.06-4.99L2.1 3.51Zm5.7 5.7A3.99 3.99 0 0 0 8 12a4 4 0 0 0 6.79 2.79l-1.51-1.51A2 2 0 0 1 10.72 10.72L7.8 7.8ZM12 6c5.05 0 9.27 3.11 11 7-.68 1.52-1.63 2.88-2.79 4.01l-1.43-1.43A10.45 10.45 0 0 0 21 13c-1.73-3.89-5.95-7-11-7-1.4 0-2.74.24-3.99.68L4.64 5.31A12.85 12.85 0 0 1 12 6Z" />
                        </svg>
                    </button>
                    <span id="pwdToggleHint" class="hidden">Toggle password visibility</span>
                </div>
            </div>

            <div id="msgError" class="msg msg--error text--caption hidden" role="alert"></div>

            <div class="actionsRow">
                <button id="btnCancel" class="btn btn--ghost" type="button">Cancel</button>
                <button id="btnLogin" class="btn btn--primary" type="button">Log In</button>
            </div>
        </section>
    </main>

    <footer id="footerBar" class="footerBar" role="status" aria-live="polite">
        <div id="msgStatus" class="text--caption"></div>
    </footer>

    <script>
        // -------------------------
        // Standalone GoDaddy wiring (replaces Wix postMessage)
        // -------------------------
        const state = { busy: false };
        const BOOT = (window.MA_BOOT && typeof window.MA_BOOT === "object") ? window.MA_BOOT : {};
        const ROUTES = (BOOT.routes && typeof BOOT.routes === "object") ? BOOT.routes : {};

        function resolveRoute(actionKey) {
            const key = String(actionKey || "").trim();
            if (key && ROUTES[key]) return ROUTES[key];
            if (ROUTES.home) return ROUTES.home;
            return "/";
        }

        // Adjust if you host under a subfolder (e.g., /matchaid/...)
        const API = {
            login: "/api/auth/login.php",
            contextUser: "/services/context/service_ContextUser.php",   // if you expose it (recommended)
            logout: "/api/auth/logout.php"                     // create if you don't have it yet
        };

        const $ = (id) => document.getElementById(id);

        function setBusy(on) {
            state.busy = !!on;
            $("busyBadge").classList.toggle("hidden", !state.busy);
            $("btnLogin").disabled = state.busy;
            $("btnCancel").disabled = state.busy;
            $("inputUserId").disabled = state.busy;
            $("inputPassword").disabled = state.busy;
            $("btnPwdToggle").disabled = state.busy;
        }

        function setStatus(message, level) {
            const bar = $("footerBar");
            const el = $("msgStatus");
            if (el) el.textContent = message || "";

            bar.classList.remove("is-success", "is-warn", "is-error", "is-info");
            if (level === "success") bar.classList.add("is-success");
            else if (level === "warn") bar.classList.add("is-warn");
            else if (level === "error") bar.classList.add("is-error");
            else if (level === "info") bar.classList.add("is-info");
        }

        function showError(msg) {
            $("msgError").textContent = msg || "";
            $("msgError").classList.toggle("hidden", !msg);
            if (msg) setStatus(msg, "warn");
        }

        function validate() {
            const rawUserId = String($("inputUserId").value || "").trim();
            const password = String($("inputPassword").value || "").trim();

            // Same rules you already use:
            const isEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(rawUserId);
            const isNumericId = /^\d+$/.test(rawUserId);

            if (!rawUserId) return { ok: false, msg: "Please enter a valid Email or User-ID." };
            if (!isEmail && !isNumericId) return { ok: false, msg: "Please enter a valid Email or User-ID." };
            if (!password) return { ok: false, msg: "Please enter a Password." };

            return { ok: true, userId: rawUserId, password };
        }

        async function apiPostJson(url, bodyObj) {
        try {
            const res = await fetch(url, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            credentials: "same-origin",
            body: JSON.stringify(bodyObj || {})
            });

            const text = await res.text();
            let json = {};
            try { json = JSON.parse(text || "{}"); } catch (_) {}

            if (!res.ok && !json.ok) {
            const msg = json.message || `Request failed (${res.status})`;
            return { ok: false, message: msg, status: res.status, raw: json };
            }
            return json;

        } catch (err) {
            console.error("apiPostJson: network failure", { url, err });
            return {
            ok: false,
            message: "Network error contacting the server (connection reset). Please retry.",
            status: 0
            };
        }
        }


        async function initFromServer() {
            // Optional but nice: prefill storedEmail + subtitle from server session
            // If you don't have this endpoint yet, you can skip it—UI still works.
            try {
                const res = await fetch(API.contextUser, { credentials: "same-origin" });
                if (!res.ok) return;

                const ctx = await res.json();

                // Suggested shape: { ok:true, storedEmail:"...", subtitle:"..." }
                if (ctx && ctx.ok) {
                    if (ctx.subtitle) $("subtitle").textContent = String(ctx.subtitle);
                    if (ctx.storedEmail) $("inputUserId").value = String(ctx.storedEmail);
                }
            } catch (_) {
                // ignore
            }

            // Focus logic matches your current behavior
            setTimeout(() => {
                if ($("inputUserId").value) $("inputPassword").focus();
                else $("inputUserId").focus();
            }, 0);
        }

        async function doLogin() {
            if (state.busy) return;

            showError("");
            setStatus("", "");

            const v = validate();
            if (!v.ok) {
                showError(v.msg);
                return;
            }

            setBusy(true);
            setStatus("Signing in…", "info");

            // Contract (recommended):
            // request: { userId, password }
            // response: { ok, message?, nextUrl? }
            const out = await apiPostJson(API.login, { userId: v.userId, password: v.password });

            setBusy(false);

            if (out && out.ok) {
                showError("");
                setStatus(out.message || "Signed in.", "success");
                const next = resolveRoute(BOOT.returnAction);
                window.location.assign(next);
                return;

            } else {
                const msg = (out && out.message) ? String(out.message) : "Invalid credentials";
                showError(msg);
                setStatus(msg, "error");
            }
        }

        async function doCancel() {
            if (state.busy) return;

            try {
                // If logout endpoint exists, clear server session
                await fetch(API.logout, { method: "POST", credentials: "same-origin" });
            } catch (_) { /* ignore */ }

            window.location.assign(resolveRoute(BOOT.cancelAction));
        }

        function wire() {
            $("btnCancel").addEventListener("click", doCancel);

            $("btnPwdToggle").addEventListener("click", () => {
                if (state.busy) return;

                const input = $("inputPassword");
                const willShow = (input.type === "password");
                input.type = willShow ? "text" : "password";

                $("icoEye").classList.toggle("hidden", !willShow);
                $("icoEyeOff").classList.toggle("hidden", willShow);

                const label = willShow ? "Hide password" : "Show password";
                $("btnPwdToggle").setAttribute("aria-label", label);
                $("btnPwdToggle").setAttribute("title", label);
            });

            $("btnLogin").addEventListener("click", doLogin);

            $("inputPassword").addEventListener("keydown", (e) => {
                if (e.key === "Enter") $("btnLogin").click();
            });
        }

        // Boot
        wire();
        initFromServer();
    </script>

